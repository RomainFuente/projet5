(function(){for(var a=function(c,d){void 0===d&&(d=!0);var g=c.parentNode,l=c.parentNode.parentNode.parentNode,f=l.querySelector(".tabs-content .active"),k=l.querySelector(c.getAttribute("href"));if(g.classList.contains("active"))return!1;l.querySelector(".tabs .active").classList.remove("active");g.classList.add("active");if(d){f.classList.add("fade");f.classList.remove("in");var h=function(){this.classList.remove("fade");this.classList.remove("active");k.classList.add("active");k.classList.add("fade");
k.offsetWidth;k.classList.add("in");f.removeEventListener("transitionend",h);f.removeEventListener("webkitTransitionEnd",h);f.removeEventListener("oTransitionEnd",h)};f.addEventListener("transitionend",h);f.addEventListener("webkitTransitionEnd",h);f.addEventListener("oTransitionEnd",h)}else k.classList.add("active"),f.classList.remove("active")},b=document.querySelectorAll(".tabs a"),e=0;e<b.length;e++)b[e].addEventListener("click",function(c){a(this)});b=function(c){var d=document.querySelector('a[href="'+
window.location.hash+'"]');null===d||d.parentNode.classList.contains("active")||a(d,void 0!==c)};window.addEventListener("hashchange",b);b()})();var tabContent=document.querySelector(".tab-content"),accueil=document.getElementById("accueil"),ficheContain=document.getElementById("product"),panierContain=document.getElementById("panier"),orderContain=document.getElementById("order-contain"),orderC=document.getElementById("orderC");orderC.classList.add("left");
var liens=[],fiche=void 0,config=document.createElement("select"),image,title,prix="Prix :",euros="\u20ac",price,priceTitle,priceNumber,priceMonnaie,description,sommeTotal=0,total=document.createElement("p"),addTotal,panier,options,response,responses,select,label,ficheDescription,form=document.getElementById("my-form");form.classList.add("hidden");var ficheNone=document.querySelector(".fiche-none"),panierNone=document.querySelector(".panier-none"),containButtonFiche=document.querySelector(".contain-button-fiche");
containButtonFiche.classList.replace("contain-button-fiche","hidden");var homeReturn=document.querySelector(".home-return"),validButtonFiche=document.querySelector(".valid-button-fiche"),containButtonPanier=document.querySelector(".contain-button-panier");containButtonPanier.classList.replace("contain-button-panier","hidden");
var shopContinue=document.querySelector(".shop-continue"),resetPanierB=document.querySelector(".reset-panier"),validButtonPanier=document.querySelector(".valid-button-panier"),errorAlert=document.createElement("p"),products=[];function get(a){return new Promise(function(b,e){var c=new window.XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&(200===c.status?b(c.responseText):e(c))};c.open("get",a,!0);c.send()})}
get("http://localhost:3000/api/cameras").then(function(a){responses=JSON.parse(a);createHomePage();createFichePage()});
function createHomePage(){for(var a=0;a<responses.length;a++){response=responses[a];lien=document.createElement("a");tabContent.appendChild(lien);lien.classList.add("article");lien.href="#product";id=document.createElement("p");id.innerHTML=responses[a]._id;id.classList.add("hidden");lien.appendChild(id);image=new Image(225,150);image.src=responses[a].imageUrl;lien.appendChild(image);title=document.createElement("h2");title.innerHTML="Mod\u00e8le : "+responses[a].name;lien.appendChild(title);price=
document.createElement("div");price.classList.add("price");priceTitle=document.createElement("p");priceNumber=document.createElement("p");priceNumber.classList.add("priceNumber");priceMonnaie=document.createElement("p");priceNumber.textContent=(responses[a].price/100).toFixed(2);priceTitle.innerHTML=prix;priceMonnaie.innerHTML=euros;lien.appendChild(price);price.appendChild(priceTitle);price.appendChild(priceNumber);price.appendChild(priceMonnaie);description=document.createElement("p");description.innerHTML=
"Description : "+responses[a].description;description.classList.add("hidden");lien.appendChild(description);select=document.createElement("select");select.textContent="Configuration : ";select.setAttribute("type","select");select.setAttribute("id","config-select");select.classList.add("hidden");lien.appendChild(select);options=responses[a].lenses;for(var b=0;b<options.length;b++){var e=document.createElement("option");e.setAttribute("value","value");e.innerHTML=options[b];select.appendChild(e)}}}
function createFichePage(){liens=document.querySelectorAll(".article");for(var a=0;a<liens.length;a++)liens[a].addEventListener("click",function(){ficheNone.classList.add("hidden");void 0===fiche&&(fiche=document.createElement("div"),fiche.classList.add("fiche"),ficheContain.insertBefore(fiche,containButtonFiche));fiche.innerHTML=event.currentTarget.innerHTML;ficheDescription=document.createElement("p");ficheDescription.innerHTML=event.currentTarget.childNodes[4].innerHTML;fiche.appendChild(ficheDescription);
label=document.createElement("label");label.setAttribute("for","config-select");label.textContent="Configurez votre appareil :";fiche.appendChild(label);config.innerHTML=event.currentTarget.lastChild.innerHTML;fiche.appendChild(config);config.setAttribute("required","");containButtonFiche.classList.replace("hidden","containButtonFiche");window.scrollBy({top:1E3,behavior:"smooth"})})}
function resetFicheContain(){void 0!==fiche&&(fiche.innerHTML="",ficheContain.removeChild(fiche),fiche=void 0,containButtonFiche.classList.replace("containButtonFiche","hidden"),ficheNone.classList.remove("hidden"));2===form.classList.length&&(form.classList.remove("in"),form.classList.replace("fade","hidden"))}
function validationFiche(){panierNone.classList.add("hidden");panier=document.createElement("div");panier.classList.add("panier");panier.innerHTML=fiche.innerHTML;panier.removeChild(panier.children[8]);panier.removeChild(panier.children[7]);panier.removeChild(panier.children[6]);panierContain.insertBefore(panier,containButtonPanier);products.push(panier.firstChild.innerHTML);localStorage.setItem("MonPanier",products);addTotal=document.querySelectorAll(".panier .priceNumber");for(var a=sommeTotal=
0;a<addTotal.length;a++)sommeTotal+=Number(addTotal[a].innerHTML);total.innerHTML="Total de la commande : "+sommeTotal.toFixed(2)+" \u20ac";panierContain.insertBefore(total,containButtonPanier);containButtonPanier.classList.replace("hidden","containButtonPanier")}
function resetPanier(){for(var a=document.querySelectorAll(".panier"),b=0;b<a.length;b++)panierContain.removeChild(a[b]);form.classList.remove("in");form.classList.replace("fade","hidden");containButtonPanier.classList.replace("containButtonPanier","hidden");panierContain.removeChild(total);panierNone.classList.remove("hidden")}function shopContinueButton(){2===form.classList.length&&(form.classList.remove("in"),form.classList.replace("fade","hidden"))}
function validationPanier(){event.preventDefault();form.classList.replace("hidden","fade");form.classList.add("in");window.scrollBy({top:1E3,behavior:"smooth"})}
function sendData(){var a=new XMLHttpRequest,b={};b.firstName=form.firstName.value;b.lastName=form.lastName.value;b.address=form.address.value;b.city=form.city.value;b.email=form.email.value;a.open("POST","http://localhost:3000/api/cameras/order");a.setRequestHeader("Content-Type","application/json");a.send(JSON.stringify({contact:b,products:products}));a.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE&&201==this.status){var e=JSON.parse(a.responseText),c=document.createElement("div");
c.classList.add("order");orderContain.appendChild(c);var d=document.createElement("p");d.innerHTML="ORINOCO vous remercie pour votre commande !";c.appendChild(d);d=document.createElement("p");d.innerHTML="Total de la commande : "+sommeTotal.toFixed(2)+" \u20ac";c.appendChild(d);d=document.createElement("p");d.innerHTML="Num\u00e9ro de commande : "+e.orderId;c.appendChild(d)}}}accueil.addEventListener("click",resetFicheContain);homeReturn.addEventListener("click",resetFicheContain);
validButtonFiche.addEventListener("click",validationFiche);shopContinue.addEventListener("click",shopContinueButton);resetPanierB.addEventListener("click",resetPanier);validButtonPanier.addEventListener("click",validationPanier);var aForm=document.getElementById("aForm");
aForm.addEventListener("click",function(a){var b=/^[a-zA-Z -]+$/,e=b.test(form.firstName.value),c=b.test(form.lastName.value),d=b.test(form.city.value),g=/^[A-Za-z0-9 ]+$/.test(form.address.value);b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,3}))$/.test(form.email.value);errorAlert.innerHTML="";1==e&&1==c&&1==d&&1==g&&1==b?(sendData(),orderC.classList.remove("left"),resetPanier()):(a.preventDefault(),
form.appendChild(errorAlert),0==e&&(a=document.createElement("span"),a.innerHTML="Pr\u00e9nom incorrect </br>",errorAlert.appendChild(a)),0==c&&(c=document.createElement("span"),c.innerHTML="Nom incorrect </br>",errorAlert.appendChild(c)),0==d&&(c=document.createElement("span"),c.innerHTML="Ville incorrecte </br>",errorAlert.appendChild(c)),0==g&&(g=document.createElement("span"),g.innerHTML="Adresse incorrect </br>",errorAlert.appendChild(g)),0==b&&(b=document.createElement("span"),b.innerHTML="Email non valide </br>",
errorAlert.appendChild(b)),window.scrollBy({top:1E3,behavior:"smooth"}))});